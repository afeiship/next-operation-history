/*!
 * name: @feizheng/next-operation-history
 * description: Operation history for next.
 * url: https://github.com/afeiship/next-operation-history
 * version: 1.0.0
 * date: 2020-03-27 20:59:47
 * license: MIT
 */
!function(){var t=t||this||window||Function("return this")(),e=t.nx||require("@feizheng/next-js-core2"),s=e.LocalStorage||require("@feizheng/next-local-storage"),a=e.SessionStorage||require("@feizheng/next-session-storage"),n=e.guid||require("next-guid"),r={max:10,engine:"local",prefix:"nx",index:-1,data:[]},i=e.declare("nx.OperationHistory",{properties:{index:{set:function(t){this.store.set("index",t)},get:function(){return this.store.get("index")}},data:{set:function(t){this.store.set("data",t)},get:function(){return this.store.get("data")||[]}},next:function(){var t=this.index;return t<this.options.max&&0<=t&&t<this.last()},prev:function(){return 0<this.index}},methods:{init:function(t){var i=this.options=e.mix(null,r,t),n=i.prefix+"__operation_history";this.store=new("local"===i.engine?s:a)(n),this.reset()},reset:function(){this.index=this.options.index,this.data=this.options.data},last:function(){return this.data.length-1},at:function(t){var i=t||this.index;return this.data[i]||null},set:function(i,t){var n=this.data;n.find(function(t){return i===t.id}).data=t,this.data=n},get:function(i){return this.data.find(function(t){return i===t.id})},sets:function(t){e.forIn(t,function(t,i){this.set(t,i)},this)},gets:function(){return this.data},forward:function(){var t=this.index;this.next&&(this.index=t+1)},back:function(){var t=this.index;this.prev&&(this.index=t-1)},push:function(t){var i=this.data;i.push({id:n(),data:t}),this.data=i.slice(-this.options.max),this.index=this.last()},replace:function(t){var i=this.data;0<i.length?(i[i.length-1].data=t,this.data=i.slice(-this.options.max),this.index=this.last()):this.push(t)}}});"undefined"!=typeof module&&module.exports&&(module.exports=i)}();